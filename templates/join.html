{% extends 'base.html' %}

{% block title %}
<title>Join room</title>
{% endblock %}


{% block content %}

<section dir="ltr">
  <!-- Horizontal material form -->
<form>
  <!-- Grid row -->
  <div class="form-group row">
    <!-- Material input -->
    <label for="inputEmail3MD" class="col-sm-2 col-form-label">Enter the room code</label>
    <div class="col-sm-10">
      <div class="md-form mt-0">
        <input class="form-control" type="text" name="code" id="code" placeholder="Room code">
      </div>
    </div>
  </div>
  <!-- Grid row -->

  <!-- Grid row -->
  <div class="form-group row">
    <!-- Material input -->
    <label for="inputPassword3MD" class="col-sm-2 col-form-label">Enter your Name</label>
    <div class="col-sm-10">
      <div class="md-form mt-0">
        <input  class="form-control" type="text" name="username" id="username" placeholder="You Name">
      </div>
    </div>
  </div>
  <!-- Grid row -->

  <!-- Grid row -->
  <div class="form-group row">
    <div class="col-sm-10">
      <button type="submit" id="submint" class="btn btn-primary btn-md">Join room</button>
    </div>
  </div>
  <!-- Grid row -->

</section>


  <script>
    document.querySelector('#submint').onclick = function(e) {
      
      const roomCode = document.querySelector('#code').value;
      
      const userName = document.querySelector('#username').value;           
      console.log('Ima here' , roomCode,userName)
      const gameSocket = new WebSocket(
              
        'ws://' + window.location.host + '/ws/' + roomCode + '/admin/'
      )
      gameSocket.onopen = function(e){
        gameSocket.send(JSON.stringify({
          'userName':userName,
        }))
        
          var url =  window.location.origin +'/wait/' +roomCode + '?username=' + userName;
          history.pushState({}, null, url);
          location.reload()   
  
      }

      
  
        

    };
  </script>
{% endblock %}