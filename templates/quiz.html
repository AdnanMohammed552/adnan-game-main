{% extends 'base.html' %}

{% block content %}
<body dir="ltr">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
<div class="container" id="quiz">
  <h1>Quiz Creation Template with Bootstrap</h1>
    <div class="form-group">
      <label for="quiz-name">Quiz Name:</label>
      <input type="text" class="form-control" id="name" name="quiz-name">
    </div>
    <div class="form-group">
      <label for="quiz-code">Quiz Code:</label>
      <input type="text" class="form-control" id="code" name="quiz-code">
    </div>
    

</div>
<div class="container">
<button id="add" type="button" class="btn btn-primary" onclick="add()">Add Another Question</button>
<button type="button" id="sub" class="btn btn-success">Create Quiz</button>
</div>
<script>
let questionCount = 1;

function add() {
  questionCount++;

  const question = document.createElement("div");
  question.classList.add("question"+questionCount);

  question.innerHTML = `
  <div class="form-group">
    <label id="qqq${questionCount}" for="question-${questionCount}">Question ${questionCount}:</label>
    <div class="input-group">
      <input type="text" class="form-control" id="question${questionCount}" name="question">
      <div class="input-group-append">
        <span class="input-group-text" onclick="deleteQuestion(${questionCount})">
          <i class="fas fa-trash"></i>
        </span>
      </div>
    </div>
  </div>

  <div class="form-group">
    <label for="quiz-timer">Timer Duration (in seconds):</label>
    <input type="number" class="form-control" id="seconds-input${questionCount}" name="quiz-timer" value="120">
  </div>

  <div class="form-group">
    <label for="option-${questionCount}-1"></label>
    <div class="input-group">
      <div class="form-check">
        <input type="radio" class="form-check-input" name="correct${questionCount}" id="correct${questionCount}-1" value="1">
        <label class="form-check-label" for="option-${questionCount}-1"></label>
      </div>
      <input type="text" class="form-control" id="answer1${questionCount}" name="optionanswerquestionCount}">
    </div>
  </div>

  <div class="form-group">
    <label for="option-${questionCount}-2"></label>
    <div class="input-group">
      <div class="form-check">
        <input type="radio" class="form-check-input" name="correct${questionCount}" id="correct${questionCount}-2" value="2">
        <label class="form-check-label" for="option-${questionCount}-2"></label>
      </div>
      <input type="text" class="form-control" id="answer2${questionCount}" name="optionanswerquestionCount}">
    </div>
  </div>

  <div class="form-group">
    <label for="option-${questionCount}-3"></label>
    <div class="input-group">
      <div class="form-check">
        <input type="radio" class="form-check-input" name="correct${questionCount}" id="correct${questionCount}-3" value="3">
        <label class="form-check-label" for="option-${questionCount}-3"></label>
      </div>
      <input type="text" class="form-control" id="answer3${questionCount}" name="answer${questionCount}">
    </div>
  </div>

  <div class="form-group">
    <label for="option-${questionCount}-4"></label>
    <div class="input-group">
      <div class="form-check">
        <input type="radio" class="form-check-input" name="correct${questionCount}" id="correct${questionCount}-4" value="4">
        <label class="form-check-label" for="option-${questionCount}-4"></label>
      </div>
      <input type="text" class="form-control" id="answer4${questionCount}" name="answer${questionCount}">
    </div>
  </div>
`;

  document.getElementById("quiz").appendChild(question);
}

    function deleteQuestion(q){
      const elements = document.getElementsByClassName('question'+q);

        while(elements.length > 0) {
          elements[0].parentNode.removeChild(elements[0]);
        }

        if (q=questionCount){
          questionCount = questionCount-1
          
        }
        if(q<questionCount){
          for(let i=q;i<= questionCount;i++){
            document.getElementById('qqq'+i).innerHTML='question'+i-1

          }
        }


    }
      document.getElementById('sub').onclick=function(e){
        console.log('tt')
        let data = []
          for (let i = 0; i <= questionCount; i++){
            try{
              console.log('this is ',i)
          const question= document.getElementById('question'+i).value

          const answer1= document.getElementById('answer1'+i).value
          const answer2= document.getElementById('answer2'+i).value
          const answer3= document.getElementById('answer3'+i).value
          const answer4= document.getElementById('answer4'+i).value
          const time= document.getElementById('seconds-input'+i).value
          console.log(question,answer1,answer2,answer3,answer4,time)

          const corr = document.querySelector('input[name="correct'+i+'"]:checked').value
          data.push(question,answer1,answer2,answer3,answer4,corr,time)


        }
        catch(err){
          console.log(err)
          continue

        }
          }

        const code = document.getElementById('code').value
        const name = document.getElementById('name').value
        data.push(code)
        data.push(name)
        fetch('/api/endpoint/', {
          method: 'POST',
          headers: {
              'Content-Type': 'application/json'
          },
          body: JSON.stringify(data)})
        .then(response => response.json())
        .then(data => console.log(data))
        .catch(error => console.error(error));
          console.log('data is ',data)


      }


      

  


</script>

</body>

{% endblock %}