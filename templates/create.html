{% extends 'base.html' %}
{% block title %}
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Create New room</title>
{% endblock %}
{% block content %}
{% if request.user.is_authenticated %}

                    {% for message in messages %}
                        <li class="{{ message.tags }}">
                            {% if 'safe' in message.tags %}{{ message|safe }}{% else %}{{ message }}{% endif %}
                        </li>
                    {% endfor %}
        <div  dir="ltr">
        <label id="jwrn" style="color: white" for="exampleInputEmail1">ENTER ROOM CODE</label>
        <input type="number" class="form-control" name="roomname" id="code" placeholder="ROOM CODE" value="{{room}}" disabled>  
        <label id="grjwngo" style="color: white" for="exampleInputPassword1">ADMIN NAME</label>
        <input type="text" maxlength="15" name="username" class="form-control" value="{{request.user.username}}" id="username" placeholder="ADMIN NAME" disabled>
      
        <div class="form-group row">
            <div class="col-sm-10">
              <button type="button" id="admin" class="btn btn-primary btn-md">Create &amp; Admin</button>
            </div>
          </div>
        </div>
        <script>
          const lang = '{{lang}}'
  console.log('ff',lang)
  if(lang=='arabic'){
    
    document.getElementById('jwrn').innerHTML = 'أدخل رمز الغرفة'
    document.getElementById('grjwngo').innerHTML = 'أدخل إسم المدير'
    document.getElementById('admin').innerHTML = 'إنشاء وإدارة الغرفة'



  
  }
             document.querySelector('#admin').onclick = function(e){
                var roomCode = document.querySelector('#code').value;
                var userName = document.querySelector('#username').value;
                if(isNaN(parseInt(roomCode))){
                    alert('Error, pleasr enter numbers')
                }
                else{
                    if (roomCode.toString().length <9){
                    sessionStorage.setItem("pageState", "redirected");

                    // Redirect to the new URL using window.location
                    window.location.href =  window.location.origin + '/' +roomCode + '/admin';
                    
                    // Add an event listener for the "pageshow" event, which is triggered when the user navigates back to the page
                    window.addEventListener("pageshow", function(event) {
                      // Check if the page state is set to "redirected"
                      if (sessionStorage.getItem("pageState") === "redirected") {
                        // Reload the page to update its content
                        window.location.reload();
                        // Reset the page state to avoid an infinite loop
                        sessionStorage.setItem("pageState", "reloaded");
                      }
                    });
            }
            else{
                alert('Error, It should be less than 9 digits')
            }  
                }
               

            };
            function func(id){
                document.getElementById('btn').innerHTML = id;
            }
          </script>
{% else %}
        <button type="submit" id="SignUp" class="form-control">SignUp</button>
        <button type="submit" id="Login" class="form-control">Login</button>

        <script>
            document.getElementById('SignUp').onclick = function(e) {
                sessionStorage.setItem("pageState", "redirected");

// Redirect to the new URL using window.location
window.location.href = window.location.origin +'/account/signup'

// Add an event listener for the "pageshow" event, which is triggered when the user navigates back to the page
window.addEventListener("pageshow", function(event) {
  // Check if the page state is set to "redirected"
  if (sessionStorage.getItem("pageState") === "redirected") {
    // Reload the page to update its content
    window.location.reload();
    // Reset the page state to avoid an infinite loop
    sessionStorage.setItem("pageState", "reloaded");
  }
});
            }

            document.getElementById('Login').onclick = function(e) {
                sessionStorage.setItem("pageState", "redirected");

                // Redirect to the new URL using window.location
                window.location.href = window.location.origin +'/account/login'
                
                // Add an event listener for the "pageshow" event, which is triggered when the user navigates back to the page
                window.addEventListener("pageshow", function(event) {
                  // Check if the page state is set to "redirected"
                  if (sessionStorage.getItem("pageState") === "redirected") {
                    // Reload the page to update its content
                    window.location.reload();
                    // Reset the page state to avoid an infinite loop
                    sessionStorage.setItem("pageState", "reloaded");
                  }
                });            }
        </script>

{% endif %}
{% endblock %}