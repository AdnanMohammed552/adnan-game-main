{% extends 'base.html' %}


{% block content %}
{% for i in z %}

<center>
<button type="submit" class="btn btn-primary" id="{{i.players}}" onclick="redirect('{{i.id}}')" style="background-color: green;">{{i.players}}</button>

<h3>{{i.date}}</h3>
</center>
{% endfor %}

{{ room_code|json_script:'json-roomcode' }}

<script>
    const roomCode = JSON.parse(document.getElementById('json-roomcode').textContent);

    function redirect(code){
        console.log('mu code',code)
        
  // Store the current page state in a session storage variable
sessionStorage.setItem("pageState", "redirected");

// Redirect to the new URL using window.location
window.location.href =  window.location.origin +'/account/game/quiz/' +roomCode+'/last/'+code

// Add an event listener for the "pageshow" event, which is triggered when the user navigates back to the page
window.addEventListener("pageshow", function(event) {
  // Check if the page state is set to "redirected"
  if (sessionStorage.getItem("pageState") === "redirected") {
    // Reload the page to update its content
    window.location.reload();
    // Reset the page state to avoid an infinite loop
    sessionStorage.setItem("pageState", "reloaded");
  }
});
    }

</script>

{% endblock %}